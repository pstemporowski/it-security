import math
publicKey = 454145640230638212750304152888056691565731667133280308022404584160880070041948482167325070246353733795210658732776782747387089003660020471968284842552371138641422772409248857701361665618797106131621498353337603297357215106105153902869698036019705255939483831095377163307480179509231247419726796390198400061288130779377237316174318213073737814252619118650757688638809786320440034764046634064207019418593417554047553095398608190950109785425842417445052931345965649792443667665416535890118168206251511897127959656161732322849019637114150120642418461040658540782093682668655312841092752231934938650871876627465631637549923118728671868095289245918704330443967203009888423573118545879302336154929128809258944298670866564901975155042841372981494012297003163828243611619405899428890203043831855444241397711662084721426147182799201642295781897432388928878729268186587495178213629046017188537553094553997338288095673311672294748919882496377752175212430031529104272362655898832189204764306042183907204316933509331566120236498299377193212055297048627670048696863926143908461036262539730751888829385320781642131621079919599425659735407863568307501435883357145802466071069530541077328906044137482284120660951773744302249452031431324119516424218279
publicE = 65537;
CipherText = 81209856570171620405405065747025931275106716676218653805559403493377949376120346409623783609325019595431471397002611576448483625854186712271940116197590211567235959849568354654243399351419375534297182304799117038588085157088153696830774840033193839889192225858895658492063617049141442334362367316237590988125997806906284760889056186827819977939773037053154762809334163651062216780030417207914379472767507625378500325961164882998695483746775857316661923131866041565437838722289918548622842766516219899198578899973038606394820706932679853650475054872441181395088902151475397864453611197414451075144848254333944547246577691393511964905549131558528321795832715960079102203393709325023554559405534254845207425433340711459055632495916556795631675041118737251576580164371849659824888554415683687900351859109888159007910866798065234614305644871786837840008509177310476660090582051566062136649044318827317758664497065690696500836415307363889581523995012091144352940179510644134640980433123309311957707643833879665281467363987200539345643030006978932109549079367684105562073292339574637191473502266878154486829328353044764176297775114651675877081227310559540361956858909040272988561234726336005980960750812381666843400623505005878881538985150
otherPublicKey = 643002198229170684284920824354771822353872267953427379868646900515827222374820072499126367876478586702500900023276191899016362292318951393568154321144473118713931020237017996519771522706342327170378090015813287489133493083668004038094359569881201878252829949682471665971357974301681624071464385682221289614486408219875378894165344654003896580054968533487061160704241158958697755663563328886050889013578618105182347797726604234256173197090390098201108899452589977165758376571189361670404398314383258804574423483365498934033136799656576336765050080156971235335111222410986924882475627505877581186012186463464519321881174309275689487552826077024324554488623615479645484783076459906590652461077772838633732683988862428807101828872269959809595815457236906687084922287859601560067500928310084237336388147336284695723898536020543299819681838321657783094805082656065589535323910666113797941817090277783697397917232659492199431867304590634614574727510584998431145235883966054267560981233891632998802755128971709177200915885265918352276800321886430390555689424177490233701263078298808758816935749997674998626330029637409103766792498388763894470901307579471207233848741035569025098770725835911452070364914209344752879326834400374147255013414063

val = math.gcd(publicKey, otherPublicKey)
q = 0.0
p = 0.0
d = 0.0
N = 0.0
phi = 0.0

if val != 1:
    p = val
else: 
    print("P and Q arent equal")
    exit()

q = publicKey // p
print("q is ", q)
print('\n', "p is ", p, "\n")
phi = (p-1) * (q-1)

if math.gcd(phi, publicE) == 1:
    print("phi is right\n")
else:
    print("phi is wrong\n")
    exit();

d = pow(publicE, -1, phi)
print("d is", d, "\n")

plainText = pow(CipherText, d, publicKey)
print("plainText is", plainText)

